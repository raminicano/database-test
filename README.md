# 자동 증가, ULID 및 UUIDv7을 사용한 데이터베이스 성능 테스트

이 리포지토리는 MySQL 데이터베이스에서 다양한 기본 키 생성 전략의 성능을 테스트하고 비교하기 위해 설계되었습니다. 테스트되는 전략에는 자동 증가, ULID 및 UUIDv7이 포함됩니다. 특히, 높은 부하 조건에서 각 방법이 데이터베이스 성능에 미치는 영향을 확인하는 것이 목표입니다.

## 프로젝트 구조

프로젝트는 다음과 같이 구성되어 있습니다:

```plaintext
.
├── README.md
├── directory_structure.txt           # 디렉토리 구조를 나열한 텍스트 파일
├── k6_test.js                        # K6 부하 테스트 스크립트
├── nest-cli.json                     # NestJS CLI 구성 파일
├── package-lock.json                 # npm 종속성에 대한 잠금 파일
├── package.json                      # 프로젝트 종속성과 스크립트
├── src/                              # TypeScript 소스 파일
│   ├── app.controller.spec.ts
│   ├── app.controller.ts
│   ├── app.module.ts
│   ├── app.service.ts
│   ├── config/
│   │   └── database.config.ts        # 데이터베이스 구성 파일
│   ├── entities/
│   │   ├── auto-increment.entity.ts  # 자동 증가 기본 키에 대한 엔티티
│   │   ├── ulid.entity.ts            # ULID 기본 키에 대한 엔티티
│   │   └── uuidv7.entity.ts          # UUIDv7 기본 키에 대한 엔티티
│   ├── main.ts                       # 애플리케이션 진입점
│   └── speed/
│       ├── speed.controller.ts       # 성능 테스트 API를 위한 컨트롤러
│       ├── speed.module.ts           # 성능 테스트 모듈
│       └── speed.service.ts          # 성능 테스트 로직을 처리하는 서비스
├── test/                             # 엔드 투 엔드 테스트를 위한 테스트 파일
│   ├── app.e2e-spec.ts
│   └── jest-e2e.json
├── tsconfig.build.json               # 빌드를 위한 TypeScript 구성 파일
└── tsconfig.json                     # TypeScript 구성 파일
```

## 개요

이 프로젝트는 MySQL 데이터베이스 환경에서 세 가지 기본 키 생성 전략의 성능을 측정하고 비교하는 것을 목적으로 합니다:

- **자동 증가**: 데이터베이스에서 생성된 순차적인 정수 기반 기본 키.
- **ULID**: 고유성과 정렬 가능성을 제공하는 사전 순으로 정렬 가능한 식별자.
- **UUIDv7**: 무작위성과 시간 순서를 결합한 시간 기반 UUID.

## 성능 테스트

### 테스트 방법론

이 프로젝트에는 `k6_test.js`라는 부하 테스트 스크립트가 포함되어 있으며, 이를 통해 [K6](https://k6.io/)를 사용해 높은 부하 조건을 시뮬레이션합니다. 테스트는 다음과 같은 주요 지표를 측정하는 데 중점을 둡니다:

- **평균 응답 시간**: 삽입 작업을 처리하는 데 평균적으로 소요되는 시간.
- **최대 응답 시간**: 삽입 작업 중 기록된 가장 긴 시간.
- **전체 처리량**: 초당 처리된 작업의 총 수.

### 테스트 실행

1. **데이터베이스 설정**:

   - MySQL이 실행 중이고 올바르게 구성되었는지 확인하세요. `src/config/database.config.ts` 파일을 열어 데이터베이스 자격 증명을 업데이트합니다.

2. **종속성 설치**:

   ```bash
   npm install
   ```

3. **애플리케이션 실행**:

   ```bash
   npm run start
   ```

4. **부하 테스트 실행**:
   ```bash
   k6 run k6_test.js
   ```

### 결과 및 분석

부하 테스트를 실행한 후, 결과는 콘솔에 표시됩니다. 테스트의 주요 지표는 높은 부하 조건에서 어떤 기본 키 전략이 가장 성능이 좋은지를 판단하는 데 도움이 됩니다.

부하 테스트의 결과:

| **지표**           | **자동 증가** | **ULID** | **UUIDv7** |
| ------------------ | ------------- | -------- | ---------- |
| **평균 응답 시간** | 741.44 µs     | 1.05 ms  | 813.42 µs  |
| **최대 응답 시간** | 66.86 ms      | 72.76 ms | 48.97 ms   |
| **처리량**         | 높음          | 중간     | 높음       |

### 결론

성능 테스트를 바탕으로 다음과 같은 결론을 도출할 수 있었습니다.:

- **자동 증가**: 가장 일관되고 빠른 성능을 제공하므로, 예측 가능성과 속도가 중요한 시나리오에 이상적입니다.
- **ULID**: 고유성과 정렬 가능성을 제공하지만, 특히 부하가 높은 상황에서 성능 저하를 겪을 수 있습니다.
- **UUIDv7**: 시간 기반 고유 식별자의 필요성과 성능 간의 균형을 잘 유지하며, 시간 순서가 중요한 시나리오에서 우수한 성능을 발휘합니다.
